{"version":3,"mappings":"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","names":["N","F","r","t","e","j","w","y","S","n","o","T","a","k","M","x","__vitePreload","Q","U","A","c","f","u","m","i","g","q","d","v","B","R","E","K","P","I","D","W","J","V","s","p","l","G","h","b","_a"],"ignoreList":[0],"sources":["../../node_modules/@arcgis/core/arcade/functions/knowledgegraph.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../../config.js\";import r from\"../ArcadePortal.js\";import t from\"../Dictionary.js\";import{ArcadeExecutionError as n,ExecutionErrorCodes as o}from\"../executionError.js\";import{B as a,w as i,o as s,J as p,K as l,e as c,f,g as u,n as m,h as d}from\"../../chunks/languageUtils.js\";import{getPortal as h}from\"../portalUtils.js\";import g from\"../../geometry/Geometry.js\";import{load as w,project as y,isLoaded as j}from\"../../geometry/projectionUtils.js\";import S from\"../../geometry/SpatialReference.js\";import{webMercatorToGeographic as v,geographicToWebMercator as R}from\"../../geometry/support/webMercatorUtils.js\";import G from\"../../portal/Portal.js\";import x from\"../../portal/PortalItem.js\";import{project as k}from\"../../rest/geometryService/project.js\";import P from\"../../rest/knowledgeGraph/Entity.js\";import b from\"../../rest/knowledgeGraph/GraphQueryStreaming.js\";import I from\"../../rest/knowledgeGraph/ObjectValue.js\";import W from\"../../rest/knowledgeGraph/Path.js\";import D from\"../../rest/knowledgeGraph/Relationship.js\";import T from\"../../rest/support/ProjectParameters.js\";import{isString as U,isArray as q,isNumber as A,isDate as J}from\"../../support/guards.js\";let N=null;async function F(r){const t=e.geometryServiceUrl??\"\";if(!t){j()||await w();for(const e of r)e.container[e.indexer]=y(e.container[e.indexer],S.WGS84);return}const n=r.map((e=>e.container[e.indexer])),o=new T({geometries:n,outSpatialReference:S.WGS84}),a=await k(t,o);for(let e=0;e<a.length;e++){const t=r[e];t.container[t.indexer]=a[e]}}async function M(e,r){const t=new x({portal:e,id:r});return await t.load(),null===N&&(N=await import(\"../../rest/knowledgeGraphService.js\")),await N.fetchKnowledgeGraph(t.url)}function Q(e,r,t,n,o){if(null===e)return null;if(U(e)||A(e))return e;if(c(e))return e.toJSDate();if(c(e))return e.toJSDate();if(f(e))return e.toStorageFormat();if(u(e))return e.toStorageString();if(m(e)){const a={};for(const i of e.keys())a[i]=Q(e.field(i),r,t,n,o),a[i]instanceof g&&o.push({container:a,indexer:i});return a}if(q(e)){const a=e.map((e=>Q(e,r,t,n,o)));for(let e=0;e<a.length;e++)a[e]instanceof g&&o.push({container:a,indexer:e});return a}return d(e)?e.spatialReference.isWGS84?e:e.spatialReference.isWebMercator&&r?v(e):e:void 0}function B(e,r){if(!e)return e;if(e.spatialReference.isWGS84&&r.spatialReference.isWebMercator)return R(e);if(e.spatialReference.equals(r.spatialReference))return e;throw new n(r,o.WrongSpatialReference,null)}function E(e,r){if(!e)return null;const t={};for(const n in e)t[n]=K(e[n],r);return t}function K(e,r){return null===e?null:q(e)?e.map((e=>K(e,r))):e instanceof P?{graphTypeName:e.typeName,id:e.id,graphType:\"entity\",properties:E(e.properties,r)}:e instanceof I?{graphType:\"object\",properties:E(e.properties,r)}:e instanceof D?{graphTypeName:e.typeName,id:e.id,graphType:\"relationship\",originId:e.originId??null,destinationId:e.destinationId??null,properties:E(e.properties,r)}:e instanceof W?{graphType:\"path\",path:e.path?e.path.map((e=>K(e,r))):null}:d(e)?B(e,r):U(e)||A(e)||J(e)?e:null}function V(e){\"async\"===e.mode&&(e.functions.knowledgegraphbyportalitem=function(t,s){return e.standardFunctionAsync(t,s,((e,p,l)=>{if(a(l,2,2,t,s),null===l[0])throw new n(t,o.PortalRequired,s);if(l[0]instanceof r){const e=i(l[1]);let r;r=t.services?.portal?t.services.portal:G.getDefault();return M(h(l[0],r),e)}if(!1===U(l[0]))throw new n(t,o.InvalidParameter,s);const c=i(l[0]);return M(t.services?.portal??G.getDefault(),c)}))},e.signatures.push({name:\"knowledgegraphbyportalitem\",min:2,max:2}),e.functions.querygraph=function(r,i){return e.standardFunctionAsync(r,i,(async(e,c,f)=>{a(f,2,4,r,i);const u=f[0];if(!s(u))throw new n(r,o.InvalidParameter,i);const m=f[1];if(!U(m))throw new n(r,o.InvalidParameter,i);null===N&&(N=await import(\"../../rest/knowledgeGraphService.js\"));let d=null;const h=p(f[2],null);if(!(h instanceof t||null===h))throw new n(r,o.InvalidParameter,i);if(h){let e=[];d=Q(h,!0,!1,r,e),e=e.filter((e=>!e.container[e.indexer].spatialReference.isWGS84)),e.length>0&&await F(e)}const g=p(f[3],!1),w=new b({openCypherQuery:m,bindParameters:d,provenanceBehavior:g?\"include\":\"exclude\"});(u?.serviceDefinition?.currentVersion??11.3)>11.2&&(w.outputSpatialReference=r.spatialReference);const y=(await N.executeQueryStreaming(u,w)).resultRowsStream.getReader(),j=[];try{for(;;){const{done:e,value:t}=await y.read();if(e)break;if(q(t))for(const n of t)j.push(K(n,r));else{const e=[];for(const n of t)e.push(K(t[n],r));j.push(e)}}}catch(S){throw S}return t.convertJsonToArcade(j,l(r),!1,!0)}))},e.signatures.push({name:\"querygraph\",min:2,max:4}))}export{V as registerFunctions};\n"],"file":"assets/knowledgegraph-VBzuNfNF.js"}