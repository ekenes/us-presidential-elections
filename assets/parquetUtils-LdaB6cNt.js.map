{"version":3,"file":"parquetUtils-LdaB6cNt.js","sources":["../../node_modules/@arcgis/core/layers/support/ParquetEncodingLocation.js","../../node_modules/@arcgis/core/layers/support/ParquetEncodingWkb.js","../../node_modules/@arcgis/core/layers/support/parquetUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as o}from\"tslib\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";let s=class extends t{constructor(o){super(o),this.type=\"location\",this.latitudeFieldName=null,this.longitudeFieldName=null}};o([r({type:[\"location\"],readOnly:!0,json:{write:!0}})],s.prototype,\"type\",void 0),o([r({json:{write:!0}})],s.prototype,\"latitudeFieldName\",void 0),o([r({json:{write:!0}})],s.prototype,\"longitudeFieldName\",void 0),s=o([e(\"esri.layers.support.ParquetEncodingLocation\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as r}from\"tslib\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";let s=class extends o{constructor(r){super(r),this.type=\"wkb\",this.primaryFieldName=null}};r([t({type:[\"wkb\"],readOnly:!0,json:{write:!0}})],s.prototype,\"type\",void 0),r([t({json:{write:!0}})],s.prototype,\"orientation\",void 0),r([t({json:{write:!0}})],s.prototype,\"primaryFieldName\",void 0),s=r([e(\"esri.layers.support.ParquetEncodingWkb\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import t from\"../../core/Error.js\";import{JSONMap as o}from\"../../core/jsonMap.js\";import n from\"../../geometry/SpatialReference.js\";import i from\"./Field.js\";import{inferLocationInfo as r}from\"./locationUtils.js\";import l from\"./ParquetEncodingLocation.js\";import s from\"./ParquetEncodingWkb.js\";import{createParquetFile as a,readGeoMetadata as m,readEsriMetadata as u}from\"../../libs/parquet/parquet.js\";const c=new o({esriGeometryPoint:\"point\",esriGeometryPolygon:\"polygon\",esriGeometryPolyline:\"polyline\",esriGeometryMultipoint:\"multipoint\"});function p(e){return c.toJSON(e)}function f(e){return c.fromJSON(e)}function d(t,o={}){return y({urls:new e(t)},o)}async function y(e,o={}){if(e.geometryType&&e.spatialReference&&e.encoding&&e.fields)return e;if(e.urls.length<1)throw new t(\"parquet:bad-input\",\"At least one url must be specified\",e);const r=await a(e.urls.getItemAt(0),{getCustomParameters:()=>o.customParameters}),l=m(r),s={...e,file:r};null==s.fields&&(s.fields=r.fields().map(e=>i.fromJSON({name:e.name,type:e.type}))),null==s.encoding&&(s.encoding=g(l,s.fields));const c=u(r);if(c)switch(c.mode){case\"z\":s.displayOptimization={mode:\"z\"};break;case\"xz\":{const e=c.multiscale;if(!e)throw new t(\"bad-format\",\"XZ display optimization requires multiscale geometries\");s.displayOptimization={mode:\"xz\",multiscale:e};break}}if(!s.encoding)return s;switch(s.encoding.type){case\"location\":null==s.spatialReference&&(s.spatialReference=n.WGS84),null==s.geometryType&&(s.geometryType=\"point\");break;case\"wkb\":{if(!l)return s;const e=l.primary_column,t=l.columns[e];if(s.geometryType||(s.geometryType=P(t)),s.spatialReference||(s.spatialReference=b(t)),s.fields)for(const o of Object.keys(l.columns))s.fields=s.fields.filter(e=>e.name!==o)}}return s}function g(e,t){if(null!=e){const t=e.primary_column,o=e.columns[t];return new s({primaryFieldName:t,orientation:o.orientation??null})}const o=r(t.map(e=>e.name));return o.latitudeFieldName&&o.longitudeFieldName?new l({latitudeFieldName:o.latitudeFieldName,longitudeFieldName:o.longitudeFieldName}):null}function w(e){switch(e){case\"Point\":return\"point\";case\"Polygon\":case\"MultiPolygon\":return\"polygon\";case\"LineString\":return\"polyline\";case\"MultiPoint\":return\"multipoint\";default:return null}}function P(e){const{geometry_types:o}=e,n=new Set;for(const t of o){const e=w(t);e&&n.add(e)}if(n.size>1)throw new t(\"unsupported\",\"Parquet mixed geometry types are not support\",{geometryTypes:n});return 1===n.size?n.values().next().value:void 0}function b(e){const t=e.crs?.id?.code;return t&&\"number\"==typeof t?new n({wkid:t}):void 0}export{y as completeParquetLayerInfo,f as fromParquetJSONGeometryType,d as getParquetLayerInfo,c as parquetGeometryTypeKebabDict,p as toParquetJSONGeometryType};\n"],"names":["s","t","o","r","e","c","p","f","y","a","l","m","i","g","u","n","P","b","w","_b","_a"],"mappings":"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","x_google_ignoreList":[0,1,2]}