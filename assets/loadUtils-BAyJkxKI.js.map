{"version":3,"file":"loadUtils-BAyJkxKI.js","sources":["../../node_modules/@arcgis/core/layers/support/LayerLoadContext.js","../../node_modules/@arcgis/core/portal/support/loadUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as t}from\"../../support/requestPresets.js\";class e{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}async fetchServiceMetadata(e,a){const s=this._serviceMetadatas.get(e);if(s)return s;const r=await t(e,a);return this._serviceMetadatas.set(e,r),r}async fetchItemData(t){const{id:e}=t;if(!e)return null;const{_itemDatas:a}=this;if(a.has(e))return a.get(e);const s=await t.fetchData();return a.set(e,s),s}async fetchCustomParameters(t,e){const a=await this.fetchItemData(t);return a&&\"object\"==typeof a&&(e?e(a):a.customParameters)||null}}export{e as LayerLoadContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{findAssociatedFeatureService as e}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";import{getPreferredHost as t}from\"../../layers/support/layerUtils.js\";function a(e){const t={id:e.id,name:e.name},a=r(e.type);return\"FeatureLayer\"!==a&&(t.layerType=a),t}async function l(e,r,l){let n;if(null==e?.layers||null==e?.tables){const u=await l.fetchServiceMetadata(r,{customParameters:s(e)?.customParameters});n=t(),(e=e||{}).layers=e.layers||u?.layers?.map(a),e.tables=e.tables||u?.tables?.map(a)}return{data:e,preferredHost:n}}function s(e){if(!e)return null;const{layers:r,tables:t}=e;return r?.length?r[0]:t?.length?t[0]:null}function n(e,r){if(null==r)return null;return[...e.layers||[],...e.tables||[]].find((e=>e.id===r))}function u(e,r){return[...e.layers||[],...e.tables||[]].filter((({layerType:e})=>e?r.includes(e):r.includes(\"ArcGISFeatureLayer\")))}function c(e){return(e?.layers?.length??0)+(e?.tables?.length??0)}function o(e){switch(e){case\"catalog\":return[\"CatalogLayer\"];case\"feature\":return[\"ArcGISFeatureLayer\"];case\"oriented-imagery\":return[\"OrientedImageryLayer\"];case\"subtype-group\":return[\"SubtypeGroupLayer\",\"SubtypeGroupTable\"]}return null}function i(e){switch(e){case\"CatalogLayer\":return\"CatalogLayer\";case\"OrientedImageryLayer\":return\"OrientedImageryLayer\";case\"SubtypeGroupLayer\":case\"SubtypeGroupTable\":return\"SubtypeGroupLayer\"}return\"FeatureLayer\"}async function y(r,t,l){if(!r?.url)return t??{};if(t??={},!t.layers){const e=await l.fetchServiceMetadata(r.url);t.layers=e.layers?.map(a)}const{serverUrl:n,portalItem:u}=await e(r.url,{sceneLayerItem:r,customParameters:s(t)?.customParameters}).catch((()=>({serverUrl:null,portalItem:null})));if(null==n)return t.tables=[],t;if(!t.tables&&u){const e=await u.fetchData().catch((()=>null));if(e?.tables)t.tables=e.tables.map(a);else{const r=await l.fetchServiceMetadata(n,{customParameters:s(e)?.customParameters}).catch((()=>null));t.tables=r?.tables?.map(a)}}if(t.tables)for(const e of t.tables)e.url=`${n}/${e.id}`;return t}export{a as createSublayerData,s as getFirstLayerOrTable,n as getLayerOrTable,c as getNumLayersAndTables,u as getSublayersByLayerType,o as instanceTypeToLayerTypes,i as layerTypeToLayerModuleType,y as populateSceneServiceItemData,l as preprocessFSItemData};\n"],"names":["e","a","s","r","t","l","n","u","_a","_b","_c","c","o","i","y","_d"],"mappings":"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","x_google_ignoreList":[0,1]}