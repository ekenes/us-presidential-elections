{"version":3,"file":"RasterPresetRendererMixin-DlH8xKT8.js","sources":["../../node_modules/@arcgis/core/rest/imageService/fetchRasterInfo.js","../../node_modules/@arcgis/core/renderers/support/RasterPresetRenderer.js","../../node_modules/@arcgis/core/layers/mixins/RasterPresetRendererMixin.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../geometry/Extent.js\";import a from\"../../geometry/Point.js\";import i from\"../../geometry/SpatialReference.js\";import l from\"../../layers/support/RasterInfo.js\";import n from\"../../layers/support/RasterStorageInfo.js\";import{parseUrl as s,encode as r,asValidOptions as o}from\"../utils.js\";import u from\"../support/FeatureSet.js\";async function m(m,f,p){const c=s(m),{rasterFunction:d,sourceJSON:h}=f||{},g=d?JSON.stringify(d.rasterFunctionDefinition||d):null,y=r({...c.query,renderingRule:g,f:\"json\"}),x=o(y,p);m=c.path;const S=h||await e(m,x).then((e=>e.data)),b=S.hasRasterAttributeTable?e(`${m}/rasterAttributeTable`,x):null,v=S.hasColormap?e(`${m}/colormap`,x):null,V=S.hasHistograms?e(`${m}/histograms`,x):null,D=S.currentVersion>=10.3?e(`${m}/keyProperties`,x):null,I=S.hasMultidimensions?e(`${m}/multidimensionalInfo`,x):null,T=await Promise.allSettled([b,v,V,D,I]);let R=null;if(S.minValues&&S.minValues.length===S.bandCount){R=[];for(let e=0;e<S.minValues.length;e++)R.push({min:S.minValues[e],max:S.maxValues[e],avg:S.meanValues[e],stddev:S.stdvValues[e]})}const j=t.fromJSON(S.extent),w=Math.ceil(j.width/S.pixelSizeX-.1),M=Math.ceil(j.height/S.pixelSizeY-.1),N=i.fromJSON(S.spatialReference||S.extent.spatialReference),O=\"fulfilled\"===T[0].status?T[0].value?.data:null,J=O?.features?.length?u.fromJSON(O):null,k=\"fulfilled\"===T[1].status?T[1].value?.data.colormap:null,C=k?.length?k:null,P=\"fulfilled\"===T[2].status?T[2].value?.data.histograms:null,z=P?.[0]?.counts?.length?P:null,F=\"fulfilled\"===T[3].status?T[3].value?.data??{}:{},$=\"fulfilled\"===T[4].status?T[4].value?.data.multidimensionalInfo:null,E=$?.variables?.length?$:null;E&&E.variables.forEach((e=>{e.statistics?.length&&e.statistics.forEach((e=>{e.avg=e.mean,e.stddev=e.standardDeviation})),e.dimensions?.forEach((e=>{\"StdTime\"!==e.name||e.recurring||e.unit||(e.unit=\"ISO8601\")}))}));const{defaultVariable:H,serviceDataType:L}=S;H&&H!==F.DefaultVariable&&(F.DefaultVariable=H),L?.includes(\"esriImageServiceDataTypeVector\")&&!L.includes(F.DataType)&&(F.DataType=L.replace(\"esriImageServiceDataType\",\"\"));let A=S.noDataValue;S.noDataValues?.length&&S.noDataValues.some((e=>e!==A))&&(A=S.noDataValues);const q=S.transposeInfo?new n({blockWidth:256,blockHeight:256,pyramidBlockWidth:256,pyramidBlockHeight:256,pyramidScalingFactor:2,compression:\"lerc\",origin:new a({x:S.extent.xmin,y:S.extent.ymax,spatialReference:N}),firstPyramidLevel:1,maximumPyramidLevel:Math.max(0,Math.round(Math.log(Math.max(w,M))/Math.LN2-8)),transposeInfo:S.transposeInfo}):void 0;return new l({width:w,height:M,bandCount:S.bandCount,extent:t.fromJSON(S.extent),spatialReference:N,pixelSize:new a({x:S.pixelSizeX,y:S.pixelSizeY,spatialReference:N}),pixelType:S.pixelType.toLowerCase(),statistics:R,attributeTable:J,colormap:C,histograms:z,keyProperties:F,noDataValue:A,multidimensionalInfo:E,storageInfo:q})}function f(e,t,a){return m(e,{sourceJSON:t},a)}function p(e,t,a){return m(e,{rasterFunction:t},a)}function c(e,t){e.attributeTable||(t.hasRasterAttributeTable=!1),e.histograms||(t.hasHistograms=!1),e.colormap||(t.hasColormap=!1),e.multidimensionalInfo||(t.hasMultidimensions=!1)}export{f as fetchServiceRasterInfo,p as generateRasterInfo,c as patchServiceInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Clonable.js\";import o from\"../../core/JSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{Integer as s}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/has.js\";import\"../../core/RandomLCG.js\";import{enumeration as i}from\"../../core/accessorSupport/decorators/enumeration.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{websceneRasterRendererTypes as n,rasterRendererTypes as a}from\"./rasterTypeUtils.js\";let d=class extends(r.ClonableMixin(o)){constructor(e){super(e),this.name=void 0,this.method=\"none\",this.value=void 0,this.bandIds=void 0,this.renderer=void 0}};e([t({type:String,json:{write:{isRequired:!0}}})],d.prototype,\"name\",void 0),e([t({type:[\"raster-function-template\",\"variable\",\"none\"],json:{write:{isRequired:!0}}}),i({rasterFunctionTemplate:\"raster-function-template\",variable:\"variable\",none:\"none\"})],d.prototype,\"method\",void 0),e([t({type:String,json:{write:{isRequired:!0}}})],d.prototype,\"value\",void 0),e([t({type:[s],json:{write:{isRequired:!0}}})],d.prototype,\"bandIds\",void 0),e([t({types:a,json:{write:!0,origins:{\"web-scene\":{types:n,write:{overridePolicy:e=>({enabled:e&&\"vector-field\"!==e.type&&\"flow\"!==e.type})}}}}})],d.prototype,\"renderer\",void 0),d=e([p(\"esri.renderers.support.RasterPresetRenderer\")],d);export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import t from\"../../renderers/support/RasterPresetRenderer.js\";const o=o=>{let i=class extends o{constructor(){super(...arguments),this.activePresetRendererName=null,this.presetRenderers=null}};return e([r({type:String,json:{name:\"layerDefinition.activePresetRendererName\",write:{allowNull:!0}}})],i.prototype,\"activePresetRendererName\",void 0),e([r({type:[t],json:{name:\"layerDefinition.presetRenderers\",write:!0}})],i.prototype,\"presetRenderers\",void 0),i=e([s(\"esri.layers.mixins.RasterPresetRendererMixin\")],i),i};export{o as RasterPresetRendererMixin};\n"],"names":["m","f","c","s","d","h","g","y","r","x","o","S","e","b","v","V","D","I","T","R","j","t","w","M","N","i","O","_a","J","_b","u","k","_c","C","P","_d","z","_f","_e","F","_g","$","_h","E","_i","H","L","A","_j","q","n","a","l","p"],"mappings":"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","x_google_ignoreList":[0,1,2]}