{"version":3,"file":"resourceUtils-DJ_gEr8P.js","sources":["../../node_modules/@arcgis/core/portal/support/resourceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../../request.js\";import t from\"../../core/Error.js\";import{join as r,getPathExtension as s}from\"../../core/urlUtils.js\";async function o(e,t={},s){await e.load(s);const o=r(e.itemUrl,\"resources\"),{start:a=1,num:n=10,sortOrder:c=\"asc\",sortField:l=\"resource\"}=t,i={query:{start:a,num:n,sortOrder:c,sortField:l,token:e.apiKey},signal:s?.signal},u=await e.portal.request(o,i);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((({created:t,size:r,resource:s})=>({created:new Date(t),size:r,resource:e.resourceFromPath(s)})))}}async function a(e,s,o,a){const n=new Map;for(const{resource:r,content:i,compress:u,access:p}of s){if(!r.hasPath())throw new t(`portal-item-resource-${o}:invalid-path`,\"Resource does not have a valid path\");const[e,s]=l(r.path),a=`${e}/${u??\"\"}/${p??\"\"}`;n.has(a)||n.set(a,{prefix:e,compress:u,access:p,files:[]});n.get(a).files.push({fileName:s,content:i})}await e.load(a);const c=r(e.userItemUrl,\"add\"===o?\"addResources\":\"updateResources\");for(const{prefix:t,compress:r,access:l,files:i}of n.values()){const s=25;for(let o=0;o<i.length;o+=s){const n=i.slice(o,o+s),u=new FormData;t&&\".\"!==t&&u.append(\"resourcesPrefix\",t),r&&u.append(\"compress\",\"true\"),l&&u.append(\"access\",l);let p=0;for(const{fileName:e,content:t}of n)u.append(\"file\"+ ++p,t,e);u.append(\"f\",\"json\"),await e.portal.request(c,{method:\"post\",body:u,signal:a?.signal})}}}async function n(e,s,o){if(!s.hasPath())throw new t(\"portal-item-resources-remove:invalid-path\",\"Resource does not have a valid path\");await e.load(o);const a=r(e.userItemUrl,\"removeResources\");await e.portal.request(a,{method:\"post\",query:{resource:s.path},signal:o?.signal}),s.portalItem=null}async function c(e,t){await e.load(t);const s=r(e.userItemUrl,\"removeResources\");return e.portal.request(s,{method:\"post\",query:{deleteAll:!0},signal:t?.signal})}function l(e){const t=e.lastIndexOf(\"/\");return-1===t?[\".\",e]:[e.slice(0,t),e.slice(t+1)]}function i(e){const[t,r]=u(e),[s,o]=l(t);return[s,o,r]}function u(e){const t=s(e);return null==t?[e,\"\"]:[e.slice(0,e.length-t.length-1),`.${t}`]}async function p(t){if(\"blob\"===t.type)return t.blob;if(\"json\"===t.type)return new Blob([t.jsonString],{type:\"application/json\"});return(await e(t.url,{responseType:\"blob\"})).data}function f(e,t){if(!e.hasPath())return null;const[s,,o]=i(e.path);return e.portalItem.resourceFromPath(r(s,t+o))}function m(e,t){if(!e.hasPath())return null;const[s,,o]=i(e.path);return e.portalItem.resourceFromPath(r(s,t+o))}export{a as addOrUpdateResources,p as contentToBlob,o as fetchResources,f as getSiblingOfSameType,m as getSiblingOfSameTypeI,c as removeAllResources,n as removeResource,i as splitPrefixFileNameAndExtension};\n"],"names":["o","r","a","n","c","l","i","u","t","s","p","e","f","m"],"mappings":"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","x_google_ignoreList":[0]}