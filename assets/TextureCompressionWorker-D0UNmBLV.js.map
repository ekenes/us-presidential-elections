{"version":3,"mappings":"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","names":["i","t","__vitePreload","s","e","r","a","l","o","u","p","m","h","n","M","c","d","f","_a","w","y","T","A","C","g","E","b","S","_","D","R"],"ignoreList":[0,1,2],"sources":["../../node_modules/@arcgis/core/libs/basisu/BasisUEncoder.js","../../node_modules/@arcgis/core/libs/dxtEncoder/DXTEncoder.js","../../node_modules/@arcgis/core/views/support/TextureCompressionWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as s}from\"../../assets.js\";function i(){return t??=(async()=>{const i=await import(\"../../chunks/basis_encoder.js\"),t=await i.default({locateFile:i=>s(`esri/libs/basisu/${i}`)});return t.initializeBasis(),t})(),t}let t;export{i as getBasisEncoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return r??=(async()=>{const e=await import(\"../../chunks/dxt_encoder.js\");return await e.default({locateFile:e=>t(`esri/libs/dxtEncoder/${e}`)})})(),r}let r;export{e as getDXTEncoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{getBasisEncoder as e}from\"../../libs/basisu/BasisUEncoder.js\";import{TextureFormat as t}from\"../../libs/basisu/TextureFormat.js\";import{getDXTEncoder as n}from\"../../libs/dxtEncoder/DXTEncoder.js\";import{CompressedTextureFormat as r}from\"../webgl/enums.js\";let a,s,l=null,i=null;class o{constructor(e,t){this.internalFormat=e,this.compressedTexture=t}}async function u(e){let t;if(t=e.data instanceof ImageBitmap?p(e.data):m(e.data,e.width,e.height,e.components,e.needsFlip),e.hasS3TC){i||await h();const n=new Uint8Array(t.length);if(i?.encode(t,e.width,e.height,e.preMultiplyAlpha,n)){const e=M(n,!0),t=[n.buffer];return{result:new o(e?.internalFormat??null,e?.textureData??null),transferList:t}}return{result:new o(null,null)}}if(e.hasETC){if(l||await c(),e.preMultiplyAlpha&&!i&&await h(),e.preMultiplyAlpha){const n=new Uint8ClampedArray(t.length);i?.premultiply(new Uint8Array(t),e.width,e.height,n),t=n}const n=await d(t,e.width,e.height,e.hasMipmap),r=n?await f(n):null,a=r?.compressedTexture?.levels.map((e=>e.buffer))||[];return{result:new o(r?.internalFormat??null,r?.compressedTexture??null),transferList:a}}return{result:new o(null,null)}}async function c(){l||(l=await(a??=e()))}async function h(){i||(i=await(s??=n()))}async function d(e,t,n,r,a=255,s=0,i=!1,o=!1){if(!l)return null;const u=new l.BasisEncoder;u.setPerceptual(!o),u.setCheckForAlpha(!0),u.setForceAlpha(!1),u.setRenormalize(o),u.setMipGen(r),u.setMipSRGB(!o),u.setCreateKTX2File(!0),u.setKTX2SRGBTransferFunc(!o),u.setQualityLevel(a),u.setCompressionLevel(s);const c=new Uint8Array(e.byteLength);u.setSliceSourceImage(0,new Uint8Array(e),t,n,i);const h=u.encode(c),d=new Uint8Array(c.buffer,0,h),f=new l.KTX2File(new Uint8Array(d));return f.isValid()?(u.delete(),d):(f.close(),f.delete(),u.delete(),null)}async function f(e){if(!l)return new o(null,null);const n=new l.KTX2File(new Uint8Array(e));n.startTranscoding();const[a,s]=n.getHasAlpha()?[t.ETC2_RGBA,r.COMPRESSED_RGBA8_ETC2_EAC]:[t.ETC1_RGB,r.COMPRESSED_RGB8_ETC2],i=n.getLevels(),u=[];for(let t=0;t<i;t++)u.push(new Uint8Array(n.getImageTranscodedSizeInBytes(t,0,0,a))),n.transcodeImage(u[t],t,0,0,a,0,-1,-1);return n.close(),n.delete(),{internalFormat:s,compressedTexture:{type:\"compressed\",levels:u}}}function p(e){const t=new OffscreenCanvas(e.width,e.height),n=t.getContext(\"2d\");n.drawImage(e,0,0);return n.getImageData(0,0,t.width,t.height).data}function m(e,t,n,r,a){const s=new Uint8ClampedArray(e).subarray(0,t*n*r);if(!a)return s;const l=new Uint8ClampedArray(s.length),i=t*r;for(let o=0;o<n;o++){const e=o*i,t=(n-o-1)*i;l.set(s.subarray(e,e+i),t)}return l}const w=31,y=1,T=2,A=3,C=4,g=7,E=21,b=131072;function S(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const _=S(\"DXT1\"),D=S(\"DXT3\"),R=S(\"DXT5\");function M(e,t){const n=new Int32Array(e.buffer,e.byteOffset,w);let a,s;switch(n[E]){case _:a=8,s=r.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case D:a=16,s=r.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case R:a=16,s=r.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}let l=1,i=n[C],o=n[A];(3&i||3&o)&&(i=i+3&-4,o=o+3&-4);const u=i,c=o;let h,d;n[T]&b&&!1!==t&&(l=Math.max(1,n[g]));let f=e.byteOffset+n[y]+4;const p=[];for(let r=0;r<l;++r)d=(i+3>>2)*(o+3>>2)*a,h=new Uint8Array(e.buffer,f,d),p.push(h),f+=d,i=Math.max(1,i>>1),o=Math.max(1,o>>1);return{textureData:{type:\"compressed\",levels:p},internalFormat:s,width:u,height:c}}export{o as TextureCompressionWorkerOutput,u as compress,d as compressRGBADataToKTX2,f as createTextureDataKTX2,c as initializeBasisEncoder,h as initializeDXTEncoder};\n"],"file":"assets/TextureCompressionWorker-D0UNmBLV.js"}