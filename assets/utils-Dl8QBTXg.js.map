{"version":3,"file":"utils-Dl8QBTXg.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/animatedFormats/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{makeHandle as t}from\"../../../../../core/handleUtils.js\";import{Milliseconds as e}from\"../../../../../core/time.js\";import{AnimatedSymbolRepeatType as r}from\"../../../../../symbols/cim/enums.js\";import{getRandomValue as i}from\"../grouping.js\";function a(t){return e(t.frameDurations.reduce(((t,e)=>t+e),0))}function n(t){const{width:e,height:r}=t,i=t.frameDurations.reverse(),a=e=>{const r=t.frameDurations.length-1-e;return t.getFrame(r)};return{frameCount:t.frameCount,duration:t.duration,frameDurations:i,getFrame:a,width:e,height:r}}function o(t,r){const{width:i,height:a,getFrame:n}=t,o=r/t.duration,s=t.frameDurations.map((t=>e(t*o)));return{frameCount:t.frameCount,duration:t.duration,frameDurations:s,getFrame:n,width:i,height:a}}function s(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.shift();return o.unshift(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}function m(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.pop();return o.push(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}class u{constructor(t,e,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;e>a;)a+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case r.None:this._currentFrame-=this._direction;break;case r.Loop:this._currentFrame=0;break;case r.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case r.None:this._currentFrame-=this._direction;break;case r.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case r.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}function h(t,h,c,f){let l,{repeatType:d}=h;if(null==d&&(d=r.Loop),!0===h.reverseAnimation&&(t=n(t)),null!=h.duration&&(t=o(t,e(1e3*h.duration))),null!=h.repeatDelay){const i=1e3*h.repeatDelay;d===r.Loop?t=m(t,e(i)):d===r.Oscillate&&(t=s(m(t,e(i/2)),e(i/2)))}if(null!=h.startTimeOffset)l=e(1e3*h.startTimeOffset);else if(null!=h.randomizeStartTime){const r=82749913,n=null!=h.randomizeStartSeed?h.randomizeStartSeed:r,o=i(c,n);l=e(o*a(t))}else l=e(0);return new u(t,l,d,f)}function c(e,r,i,a){const n=null==r.playAnimation||r.playAnimation,o=h(e,r,i,a);let s,m=o.timeToFrame;function u(){s=n?setTimeout((()=>{o.nextFrame(),m=o.timeToFrame,u()}),m):void 0}return u(),t((()=>n&&clearTimeout(s)))}export{u as Player,o as adjustDuration,m as appendDelay,h as createPlayer,a as getDuration,c as play,s as prependDelay,n as reverse};\n"],"names":["a","t","e","n","r","i","o","s","m","u","h","c","f","l","d"],"mappings":"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","x_google_ignoreList":[0]}