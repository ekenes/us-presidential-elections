{"version":3,"file":"VertexArrayObject-DjYKuFUx.js","sources":["../../node_modules/@arcgis/core/views/webgl/VertexArrayObject.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{toConst as e}from\"../../core/compilerUtils.js\";import t from\"../../core/Logger.js\";import{disposeMaybe as r}from\"../../core/maybe.js\";import{baseTypedArrayMemory as s}from\"../../core/memoryEstimations.js\";import{ResourceType as i}from\"./enums.js\";import{bindVertexBufferLayout as n}from\"./Util.js\";import{fromBuffers as o}from\"./VertexAttributeLocations.js\";const f=()=>t.getLogger(\"esri.views.webgl.VertexArrayObject\");let h=class t{constructor(t,r,s,i){this._context=t,this._indexBuffer=s,this._buffers=r instanceof Map?r:new Map([[\"geometry\",r]]),this._baseInstances=null==i?new Map:\"number\"==typeof i?new Map([[\"geometry\",i]]):i,this.locations=e(o(this._buffers))}get glName(){return this._glName}get context(){return this._context}get buffers(){return e(this._buffers)}buffer(e=\"geometry\"){return this.buffers.get(e)}get indexBuffer(){return this._indexBuffer}getByteLength(e){return this.buffer(e)?.sizeBytes??0}vertexCount(e){const t=this.buffer(e);return t?t.sizeBytes/t.layout[0].stride:0}get usedMemory(){return Array.from(this._buffers.values()).reduce((e,t)=>e+t.usedMemory,this._indexBuffer?.usedMemory??0+(this._buffers.size+(this._indexBuffer?1:0))*s)}dispose(){this._context?(this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this._indexBuffer=r(this._indexBuffer),this.disposeVAOOnly()):(this._glName||this._buffers.size>0)&&f().warn(\"Leaked WebGL VAO\")}disposeVAOOnly(){this._context?(this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._glName&&(this._context.gl.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(i.VertexArrayObject,this)),this._context=null):this._glName&&f().warn(\"Leaked WebGL VAO\")}bind(e=this.locations){const t=this._context.gl;this._glName?t.bindVertexArray(this._glName):(this._context.instanceCounter.increment(i.VertexArrayObject,this),this._glName=t.createVertexArray(),t.bindVertexArray(this._glName),this._bindLayout(e))}_bindLayout(e){const{_buffers:t,_indexBuffer:r}=this;if(t||f().error(\"Vertex buffer dictionary is empty!\"),t.forEach((t,r)=>n(this._context,e,t,this._baseInstances.get(r)??0)),null!=r){const e=this._context.gl;this._context.gl.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.glName)}}unbind(){this._context.gl.bindVertexArray(null)}shallowCloneWithBaseInstances(e){return new t(this._context,this._buffers,this._indexBuffer,e)}};export{h as VertexArrayObject};\n"],"names":["f","t","h","r","s","i","e","o","_a","n"],"mappings":"4IAI6W,MAAMA,EAAE,IAAIC,EAAE,UAAU,oCAAoC,EAAK,IAACC,EAAE,MAAMD,CAAC,CAAC,YAAY,EAAEE,EAAEC,EAAEC,EAAE,CAAC,KAAK,SAAS,EAAE,KAAK,aAAaD,EAAE,KAAK,SAASD,aAAa,IAAIA,EAAE,IAAI,IAAI,CAAC,CAAC,WAAWA,CAAC,CAAC,CAAC,EAAE,KAAK,eAAqBE,GAAN,KAAQ,IAAI,IAAc,OAAOA,GAAjB,SAAmB,IAAI,IAAI,CAAC,CAAC,WAAWA,CAAC,CAAC,CAAC,EAAEA,EAAE,KAAK,UAAUC,EAAEC,EAAE,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,OAAO,KAAK,OAAO,CAAC,IAAI,SAAS,CAAC,OAAO,KAAK,QAAQ,CAAC,IAAI,SAAS,CAAC,OAAOD,EAAE,KAAK,QAAQ,CAAC,CAAC,OAAOA,EAAE,WAAW,CAAC,OAAO,KAAK,QAAQ,IAAIA,CAAC,CAAC,CAAC,IAAI,aAAa,CAAC,OAAO,KAAK,YAAY,CAAC,cAAcA,EAAE,OAAC,QAAOE,EAAA,KAAK,OAAOF,CAAC,IAAb,YAAAE,EAAgB,YAAW,CAAC,CAAC,YAAYF,EAAE,CAAC,MAAML,EAAE,KAAK,OAAOK,CAAC,EAAE,OAAOL,EAAEA,EAAE,UAAUA,EAAE,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC,IAAI,YAAY,OAAC,OAAO,MAAM,KAAK,KAAK,SAAS,OAAM,CAAE,EAAE,OAAO,CAAC,EAAEA,IAAI,EAAEA,EAAE,aAAWO,EAAA,KAAK,eAAL,YAAAA,EAAmB,aAAY,GAAG,KAAK,SAAS,MAAM,KAAK,aAAa,EAAE,IAAIJ,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,UAAU,KAAK,SAAS,QAAQE,GAAGA,EAAE,QAAO,CAAE,EAAE,KAAK,SAAS,MAAK,EAAG,KAAK,aAAaH,EAAE,KAAK,YAAY,EAAE,KAAK,eAAc,IAAK,KAAK,SAAS,KAAK,SAAS,KAAK,IAAIH,EAAC,EAAG,KAAK,kBAAkB,CAAC,CAAC,gBAAgB,CAAC,KAAK,UAAU,KAAK,SAAS,YAAW,IAAK,MAAM,KAAK,SAAS,QAAQ,IAAI,EAAE,KAAK,UAAU,KAAK,SAAS,GAAG,kBAAkB,KAAK,OAAO,EAAE,KAAK,QAAQ,KAAK,KAAK,SAAS,gBAAgB,UAAUK,EAAE,kBAAkB,IAAI,GAAG,KAAK,SAAS,MAAM,KAAK,SAASL,EAAC,EAAG,KAAK,kBAAkB,CAAC,CAAC,KAAKM,EAAE,KAAK,UAAU,CAAC,MAAML,EAAE,KAAK,SAAS,GAAG,KAAK,QAAQA,EAAE,gBAAgB,KAAK,OAAO,GAAG,KAAK,SAAS,gBAAgB,UAAUI,EAAE,kBAAkB,IAAI,EAAE,KAAK,QAAQJ,EAAE,kBAAiB,EAAGA,EAAE,gBAAgB,KAAK,OAAO,EAAE,KAAK,YAAYK,CAAC,EAAE,CAAC,YAAYA,EAAE,CAAC,KAAK,CAAC,SAASL,EAAE,aAAa,CAAC,EAAE,KAAK,GAAGA,GAAGD,EAAC,EAAG,MAAM,oCAAoC,EAAEC,EAAE,QAAQ,CAACA,EAAEE,IAAIM,EAAE,KAAK,SAASH,EAAEL,EAAE,KAAK,eAAe,IAAIE,CAAC,GAAG,CAAC,CAAC,EAAQ,GAAN,KAAQ,CAAC,MAAMG,EAAE,KAAK,SAAS,GAAG,KAAK,SAAS,GAAG,WAAWA,EAAE,qBAAqB,EAAE,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,GAAG,gBAAgB,IAAI,CAAC,CAAC,8BAA8BA,EAAE,CAAC,OAAO,IAAIL,EAAE,KAAK,SAAS,KAAK,SAAS,KAAK,aAAaK,CAAC,CAAC,CAAC","x_google_ignoreList":[0]}