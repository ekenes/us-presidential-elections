{"version":3,"file":"GraphicManipulator-CoItpF81.js","sources":["../../node_modules/@arcgis/core/views/interactive/support/utils.js","../../node_modules/@arcgis/core/views/interactive/GraphicManipulator.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{pt2px as o}from\"../../../core/screenUtils.js\";function s(s){let t=0,a=0,e=0;return s?(\"cim\"===s.type&&s.data.symbol&&\"symbolLayers\"in s.data.symbol&&s.data.symbol.symbolLayers&&s.data.symbol.symbolLayers.map((o=>{\"CIMVectorMarker\"===o.type&&o.anchorPoint&&(Math.abs(o.anchorPoint.x)>t&&(t=o.anchorPoint.x),Math.abs(o.anchorPoint.y)>a&&(a=o.anchorPoint.y),null!=o.size&&o.size>e&&(e=o.size))})),t=o(t),a=o(a),e=o(e),{offsetX:t,offsetY:a,size:e}):{offsetX:t,offsetY:a,size:e}}export{s as getSymbolInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import o from\"../../core/Evented.js\";import{watch as i,sync as s}from\"../../core/reactiveUtils.js\";import{screenPointObjectToArray as r,pt2px as l,createScreenPointArray as n}from\"../../core/screenUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as c}from\"../../core/accessorSupport/decorators/subclass.js\";import{squaredDistance as h}from\"../../core/libs/gl-matrix-2/math/vec2.js\";import{j as p}from\"../../chunks/vec32.js\";import{create as m}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{canProjectWithoutEngine as u,project as y}from\"../../geometry/projectionUtils.js\";import{projectPointToVector as g}from\"../../geometry/projection/projectPointToVector.js\";import{getGraphicEffectiveElevationMode as b}from\"../../support/elevationInfoUtils.js\";import{getDefaultSymbol2D as d}from\"../../symbols/support/defaults.js\";import f from\"../../symbols/support/ElevationInfo.js\";import{getSymbolInfo as _}from\"./support/utils.js\";import{intersectsDrapedGeometry as v}from\"../support/drapedUtils.js\";let S=class extends e{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set(\"graphic\",t),this.attachSymbolChanged()}get elevationInfo(){const{layer:t}=this.graphic,e=t&&\"elevationInfo\"in t?t.elevationInfo:null,o=b(this.graphic),i=e?e.offset:0;return new f({mode:o,offset:i})}set focusedSymbol(t){t!==this._get(\"focusedSymbol\")&&(this._set(\"focusedSymbol\",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get(\"grabbing\")&&(this._set(\"grabbing\",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get(\"hovering\")&&(this._set(\"hovering\",t),this._updateGraphicSymbol())}set selected(t){t!==this._get(\"selected\")&&(this._set(\"selected\",t),this._updateGraphicSymbol(),this.events.emit(\"select-changed\",{action:t?\"select\":\"deselect\"}))}get _focused(){return this._get(\"hovering\")||this._get(\"grabbing\")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new o.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set(\"view\",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const o=e.geometry;if(null==o)return null;const i=this._get(\"focusedSymbol\"),s=null!=i?i:e.symbol;return\"2d\"===this.view.type?this._intersectDistance2D(this.view,t,o,s):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=i((()=>this.graphic?.symbol),(t=>{null!=t&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))}),s)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,o,i){if(null==(i=i||d(o)))return null;const s=1;let n=this._circleCollisionCache;if(\"point\"===o.type&&\"cim\"===i.type&&\"CIMPointSymbol\"===i.data.symbol?.type&&i.data.symbol.symbolLayers){const{offsetX:l,offsetY:n,size:a}=_(i),c=r(e,j),p=a/2,m=t.toScreen(o),u=m.x+l,y=m.y+n;return h(c,[u,y])<p*p?s:null}if(\"point\"!==o.type||\"simple-marker\"!==i.type)return v(e,o,t)?s:null;if(null==n||!n.originalPoint.equals(o)){const e=o,s=t.spatialReference;if(u(e.spatialReference,s)){const t=y(e,s);n={originalPoint:e.clone(),mapPoint:t,radiusPx:l(i.size)},this._circleCollisionCache=n}}if(null!=n){const o=r(e,j),a=t.toScreen?.(n.mapPoint);if(!a)return null;const c=n.radiusPx,p=a.x+l(i.xoffset),m=a.y-l(i.yoffset);return h(o,[p,m])<c*c?s:null}return null}_intersectDistance3D(t,e,o){const i=t.toMap(e,{include:[o]});return i&&g(i,C,t.renderSpatialReference)?p(C,t.state.camera.eye):null}};t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"graphic\",null),t([a()],S.prototype,\"elevationInfo\",null),t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"view\",void 0),t([a({value:null})],S.prototype,\"focusedSymbol\",null),t([a({constructOnly:!0})],S.prototype,\"layer\",void 0),t([a()],S.prototype,\"interactive\",void 0),t([a()],S.prototype,\"selectable\",void 0),t([a()],S.prototype,\"grabbable\",void 0),t([a({value:!1})],S.prototype,\"grabbing\",null),t([a()],S.prototype,\"dragging\",void 0),t([a()],S.prototype,\"hovering\",null),t([a({value:!1})],S.prototype,\"selected\",null),t([a()],S.prototype,\"cursor\",void 0),S=t([c(\"esri.views.interactive.GraphicManipulator\")],S);const C=m(),j=n();export{S as GraphicManipulator};\n"],"names":["s","t","a","e","o","S","b","i","f","_a","d","n","l","_","c","r","j","m","u","y","h","v","_b","p","g","C"],"mappings":"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","x_google_ignoreList":[0,1]}