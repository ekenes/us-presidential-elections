{"version":3,"file":"RasterWorker-DhRFWGrl.js","sources":["../../node_modules/@arcgis/core/layers/support/rasterTransforms/IdentityTransform.js","../../node_modules/@arcgis/core/layers/support/rasterTransforms/utils.js","../../node_modules/@arcgis/core/layers/support/RasterWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{enumeration as o}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import t from\"./BaseRasterTransform.js\";var e;let a=e=class extends t{constructor(){super(...arguments),this.type=\"identity\"}clone(){return new e}};r([o({IdentityXform:\"identity\"})],a.prototype,\"type\",void 0),a=e=r([s(\"esri.layers.support.rasterTransforms.IdentityTransform\")],a);export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport r from\"./GCSShiftTransform.js\";import o from\"./IdentityTransform.js\";import t from\"./PolynomialTransform.js\";const n={GCSShiftXform:r,IdentityXform:o,PolynomialXform:t};function f(r){const o=r?.type;if(!o)return null;const t=n[r?.type];if(t){const o=new t;return o.read(r),o}return null}export{f as readTransform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport r from\"../../geometry/Extent.js\";import e from\"../../geometry/Point.js\";import t from\"../../geometry/operators/support/GeographicTransformation.js\";import s from\"./PixelBlock.js\";import{decode as o}from\"./rasterFormats/RasterCodec.js\";import{split as i,clipTile as n,mosaic as a,approximateTransform as l,getLocalArithmeticNorthRotations as m}from\"./rasterFunctions/pixelUtils.js\";import{create as c}from\"./rasterFunctions/rasterFunctionHelper.js\";import{load as f,getProjectionOffsetGrid as p}from\"./rasterFunctions/rasterProjectionHelper.js\";import{computeStatisticsHistograms as u,estimateStatisticsHistograms as S}from\"./rasterFunctions/stretchUtils.js\";import{convertVectorFieldData as d,convertToLocalDirections as x}from\"./rasterFunctions/vectorFieldUtils.js\";import{readTransform as y}from\"./rasterTransforms/utils.js\";import h from\"../../renderers/support/RasterSymbolizer.js\";import{createFlowMesh as O}from\"../../views/2d/engine/flow/dataUtils.js\";class N{convertVectorFieldData(r){const e=s.fromJSON(r.pixelBlock),t=d(e,r.type);return Promise.resolve(null!=t?t.toJSON():null)}computeStatisticsHistograms(r){const e=s.fromJSON(r.pixelBlock),t=u(e);return Promise.resolve(t)}async decode(r){const e=await o(r.data,r.options);return e&&e.toJSON()}symbolize(e){e.pixelBlock=s.fromJSON(e.pixelBlock),e.extent=e.extent?r.fromJSON(e.extent):null;const t=this.symbolizer.symbolize(e);return Promise.resolve(null!=t?t.toJSON():null)}async updateSymbolizer(r){this.symbolizer=h.fromJSON(r.symbolizerJSON),r.histograms&&\"rasterStretch\"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=r.histograms)}async updateRasterFunction(r){this.rasterFunction=c(r.rasterFunctionJSON)}async process(t){const o=this.rasterFunction.process({extent:r.fromJSON(t.extent),primaryPixelBlocks:t.primaryPixelBlocks.map((r=>null!=r?s.fromJSON(r):null)),primaryPixelSizes:t.primaryPixelSizes?.map((r=>null!=r?e.fromJSON(r):null)),primaryRasterIds:t.primaryRasterIds});return null!=o?o.toJSON():null}stretch(r){const e=this.symbolizer.simpleStretch(s.fromJSON(r.srcPixelBlock),r.stretchParams);return Promise.resolve(e?.toJSON())}estimateStatisticsHistograms(r){const e=S(s.fromJSON(r.srcPixelBlock));return Promise.resolve(e)}split(r){const e=i(s.fromJSON(r.srcPixelBlock),r.tileSize,r.maximumPyramidLevel??0,!1===r.useBilinear);return e&&e.forEach(((r,t)=>{e.set(t,r?.toJSON())})),Promise.resolve(e)}clipTile(r){const e=s.fromJSON(r.pixelBlock),t=n({...r,pixelBlock:e});return Promise.resolve(t?.toJSON())}async mosaicAndTransform(r){const e=r.srcPixelBlocks.map((r=>r?new s(r):null)),t=a(e,r.srcMosaicSize,{blockWidths:r.blockWidths,alignmentInfo:r.alignmentInfo,clipOffset:r.clipOffset,clipSize:r.clipSize});let o,i=t;return r.coefs&&(i=l(t,r.destDimension,r.coefs,r.sampleSpacing,r.interpolation)),r.projectDirections&&r.gcsGrid&&(o=m(r.destDimension,r.gcsGrid),i=x(i,r.isUV?\"vector-uv\":\"vector-magdir\",o)),{pixelBlock:i?.toJSON(),localNorthDirections:o}}async createFlowMesh(r,e){const t={data:new Float32Array(r.flowData.buffer),mask:new Uint8Array(r.flowData.maskBuffer),width:r.flowData.width,height:r.flowData.height},{vertexData:s,indexData:o}=await O(r.meshType,r.simulationSettings,t,e.signal);return{result:{vertexBuffer:s.buffer,indexBuffer:o.buffer},transferList:[s.buffer,o.buffer]}}async getProjectionOffsetGrid(e){const s=r.fromJSON(e.projectedExtent),o=r.fromJSON(e.srcBufferExtent);let i=null;e.datumTransformationSteps?.length&&(i=new t({steps:e.datumTransformationSteps})),await f();const n=e.rasterTransform?y(e.rasterTransform):null;return p({...e,projectedExtent:s,srcBufferExtent:o,datumTransformation:i,rasterTransform:n})}}export{N as default};\n"],"names":["e","a","t","r","o","s","n","f","N","d","u","h","_a","c","S","i","l","m","x","O","y","p"],"mappings":"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","x_google_ignoreList":[0,1,2]}