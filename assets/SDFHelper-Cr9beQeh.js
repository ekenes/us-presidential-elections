import{aO as X,aP as k,aQ as L,aR as Y,aS as j}from"./index-CQU_kJbH.js";const q=.45;function G(n,t=.5){var a;switch(n.type){case"CIMPointSymbol":{const o=n.symbolLayers;if(!o||o.length!==1)return null;const r=o[0];return r.type!=="CIMVectorMarker"?null:G(r)}case"CIMVectorMarker":{const o=n.markerGraphics;if(!o||o.length!==1)return null;const r=o[0];if(!r)return null;const e=r.geometry;if(!e)return null;const i=r.symbol;return!i||i.type!=="CIMPolygonSymbol"&&i.type!=="CIMLineSymbol"||(a=i.symbolLayers)!=null&&a.some((l=>!!l.effects))?null:{type:"sdf",geom:e,sdfPaddingRatio:t,asFill:i.type==="CIMPolygonSymbol"}}}}function O(n){return n?n.rings?n.rings:n.paths?n.paths:n.xmin!==void 0&&n.ymin!==void 0&&n.xmax!==void 0&&n.ymax!==void 0?[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]:null:null}function Q(n){let t=1/0,a=-1/0,o=1/0,r=-1/0;for(const e of n)for(const i of e)i[0]<t&&(t=i[0]),i[0]>a&&(a=i[0]),i[1]<o&&(o=i[1]),i[1]>r&&(r=i[1]);return new Y(t,o,a-t,r-o)}function V(n){let t=1/0,a=-1/0,o=1/0,r=-1/0;for(const e of n)for(const i of e)i[0]<t&&(t=i[0]),i[0]>a&&(a=i[0]),i[1]<o&&(o=i[1]),i[1]>r&&(r=i[1]);return[t,o,a,r]}function U(n){return n?n.rings?V(n.rings):n.paths?V(n.paths):X(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function K(n,t){const[a,o,r,e]=U(n),i=r-a,l=e-o,c=k,h=L,s=Math.floor(.5*(c*t-h)),f=(c-2*(s+h))/Math.max(i,l),d=Math.round(i*f),m=Math.round(l*f);return{pixelDimensions:[i,l],texelDimensions:[Math.round((d+2*s)/f),Math.round((m+2*s)/f)]}}function N(n,t,a,o,r,e,i){const[l,c,h,s]=n;if(h<l||s<c)return{frameSizeRatio:0,anchorX:0,anchorY:0,widthRatio:1,sdfPaddingRatio:.5};const f=h-l,d=s-c,m=Math.max(f,d);let u=.5;if(e!=null&&a!=null){!i&&t!=null&&(e*=(t.ymax-t.ymin)/a);const C=e/(e+m);C>q&&C<1&&(u=Math.min(C+.1,.99))}const x=k,M=L,p=Math.floor(.5*(x*u-M)),g=(x-2*(p+M))/m,S=Math.round(f*g)+2*p,P=Math.round(d*g)+2*p;let y=1;t&&(y=P*(1-u)/((t.ymax-t.ymin)*g));let w=0,R=0,b=1;o&&(r?t&&a&&t.ymax-t.ymin>0&&(b=(t.xmax-t.xmin)/(t.ymax-t.ymin),w=o.x/(a*b),R=o.y/a):(w=o.x,R=o.y)),t&&(w=.5*(t.xmax+t.xmin)+w*(t.xmax-t.xmin),R=.5*(t.ymax+t.ymin)+R*(t.ymax-t.ymin)),w-=l,R-=c,w*=g,R*=g,w+=p,R+=p;let I=w/S-.5,v=R/P-.5;return r&&a&&(I*=a*b,v*=a),{frameSizeRatio:y,anchorX:I,anchorY:v,widthRatio:b,sdfPaddingRatio:u}}function T(n){const t=O(n.geom),a=Q(t),o=k,r=L,e=Math.floor(.5*(o*n.sdfPaddingRatio-r)),i=o-2*(e+r),l=i/Math.max(a.width,a.height),c=Math.round(a.width*l)+2*e,h=Math.round(a.height*l)+2*e,s=[];for(const d of t)if(d&&d.length>1){const m=[];for(const u of d){let[x,M]=u;x-=a.x,M-=a.y,x*=l,M*=l,x+=e-.5,M+=e-.5,n.asFill?m.push([x,M]):m.push([Math.round(x),Math.round(M)])}if(n.asFill){const u=m.length-1;m[0][0]===m[u][0]&&m[0][1]===m[u][1]||m.push(m[0])}s.push(m)}const f=B(s,c,h,e);return n.asFill&&E(s,c,h,e,f),{data:H(f,e),width:c,height:h,sdfPaddingRatio:n.sdfPaddingRatio,sdfDecodeCoeff:2*e/i}}function B(n,t,a,o){const r=t*a,e=new Array(r),i=o*o+1;for(let l=0;l<r;++l)e[l]=i;for(const l of n){const c=l.length;for(let h=1;h<c;++h){const s=l[h-1],f=l[h];let d,m,u,x;s[0]<f[0]?(d=s[0],m=f[0]):(d=f[0],m=s[0]),s[1]<f[1]?(u=s[1],x=f[1]):(u=f[1],x=s[1]);let M=Math.floor(d)-o,p=Math.floor(m)+o,g=Math.floor(u)-o,S=Math.floor(x)+o;M<0&&(M=0),p>t&&(p=t),g<0&&(g=0),S>a&&(S=a);const P=f[0]-s[0],y=f[1]-s[1],w=P*P+y*y;for(let R=M;R<p;R++)for(let b=g;b<S;b++){const I=R+.5,v=b+.5;let C,F,D=(I-s[0])*P+(v-s[1])*y;D<0?(C=s[0],F=s[1]):D>w?(C=f[0],F=f[1]):(D/=w,C=s[0]+D*P,F=s[1]+D*y);const z=(I-C)*(I-C)+(v-F)*(v-F),A=(a-b-1)*t+R;z<e[A]&&(e[A]=z)}}}for(let l=0;l<r;++l)e[l]=Math.sqrt(e[l]);return e}function E(n,t,a,o,r){for(const e of n){const i=e.length;for(let l=1;l<i;++l){const c=e[l-1],h=e[l];let s,f,d,m;c[0]<h[0]?(s=c[0],f=h[0]):(s=h[0],f=c[0]),c[1]<h[1]?(d=c[1],m=h[1]):(d=h[1],m=c[1]);let u=Math.floor(s),x=Math.floor(f)+1,M=Math.floor(d),p=Math.floor(m)+1;u<o&&(u=o),x>t-o&&(x=t-o),M<o&&(M=o),p>a-o&&(p=a-o);for(let g=M;g<p;++g){if(c[1]>g==h[1]>g)continue;const S=g+.5,P=(a-g-1)*t;for(let y=u;y<x;++y)y+.5<(h[0]-c[0])*(S-c[1])/(h[1]-c[1])+c[0]&&(r[P+y]=-r[P+y]);for(let y=o;y<u;++y)r[P+y]=-r[P+y]}}}}function H(n,t){const a=2*t,o=n.length,r=new Uint8Array(4*o);for(let e=0;e<o;++e){const i=.5-n[e]/a;j(i,r,4*e)}return r}export{G as a,K as c,N as h,U as m,T as u};
//# sourceMappingURL=SDFHelper-Cr9beQeh.js.map
