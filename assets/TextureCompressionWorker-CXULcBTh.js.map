{"version":3,"mappings":"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","names":["s","t","__vitePreload","i","a","e","n","r","l","u","c","h","w","y","d","U","f","p","m","_a","o","T","A","g","C","E","S","b","_","D","M","X","R"],"ignoreList":[0,1,2],"sources":["../../node_modules/@arcgis/core/libs/basisu/BasisUEncoder.js","../../node_modules/@arcgis/core/libs/dxtEncoder/DXTEncoder.js","../../node_modules/@arcgis/core/views/support/TextureCompressionWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as i}from\"../../assets.js\";function s(){return t??=(async()=>{const s=await import(\"../../chunks/basis_encoder.js\"),t=await s.default({locateFile:s=>i(`esri/libs/basisu/${s}`)});return t.initializeBasis(),t})(),t}let t;function a(){t=null}export{a as destroyBasisEncoder,s as getBasisEncoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n??=(async()=>{const e=await import(\"../../chunks/dxt_encoder.js\");return await e.default({locateFile:e=>t(`esri/libs/dxtEncoder/${e}`)})})(),n}let n;function r(){n=null}export{r as destroyDXTEncoder,e as getDXTEncoder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{getBasisEncoder as e,destroyBasisEncoder as t}from\"../../libs/basisu/BasisUEncoder.js\";import{getDXTEncoder as n,destroyDXTEncoder as r}from\"../../libs/dxtEncoder/DXTEncoder.js\";import{CompressedTextureFormat as a}from\"../webgl/enums.js\";let l,s,i=null,o=null;class u{constructor(e,t){this.internalFormat=e,this.compressedTexture=t}}function c(){i=null,l=null,o=null,s=null,t(),r()}async function h(e){let t;t=e.data instanceof ImageBitmap?w(e.data):y(e.data,e.width,e.height,e.components,e.needsFlip);try{if(e.hasS3TC){o||await d();const n=new Uint8Array(t.length);if(o?.encode(t,e.width,e.height,e.preMultiplyAlpha,n)){const e=U(n,!0),t=[n.buffer];return{result:new u(e?.internalFormat??null,e?.textureData??null),transferList:t}}return{result:new u(null,null)}}if(e.hasETC){if(i||await f(),e.preMultiplyAlpha&&!o&&await d(),e.preMultiplyAlpha){const n=new Uint8ClampedArray(t.length);o?.premultiply(new Uint8Array(t),e.width,e.height,n),t=n}const n=p(t,e.width,e.height,e.hasMipmap),r=n?m(n):null,a=r?.compressedTexture?.levels.map(e=>e.buffer)||[];return{result:new u(r?.internalFormat??null,r?.compressedTexture??null),transferList:a}}return{result:new u(null,null)}}finally{t instanceof ImageBitmap&&t.close()}}async function f(){i||(i=await(l??=e()),l=null)}async function d(){o||(o=await(s??=n()),s=null)}function p(e,t,n,r,a=255,l=0,s=!1,o=!1){if(!i)return null;const u=new i.BasisEncoder;u.setPerceptual(!o),u.setCheckForAlpha(!0),u.setForceAlpha(!1),u.setRenormalize(o),u.setMipGen(r),u.setMipSRGB(!o),u.setCreateKTX2File(!0),u.setKTX2SRGBTransferFunc(!o),u.setQualityLevel(a),u.setCompressionLevel(l);const c=new Uint8Array(e.byteLength);u.setSliceSourceImage(0,new Uint8Array(e),t,n,s);const h=u.encode(c),f=new Uint8Array(c.buffer,0,h),d=new i.KTX2File(new Uint8Array(f));return d.isValid()?(u.delete(),f):(d.close(),d.delete(),u.delete(),null)}function m(e){if(!i)return new u(null,null);const t=new i.KTX2File(new Uint8Array(e));t.startTranscoding();const[n,r]=t.getHasAlpha()?[1,a.COMPRESSED_RGBA8_ETC2_EAC]:[0,a.COMPRESSED_RGB8_ETC2],l=t.getLevels(),s=[];for(let a=0;a<l;a++)s.push(new Uint8Array(t.getImageTranscodedSizeInBytes(a,0,0,n))),t.transcodeImage(s[a],a,0,0,n,0,-1,-1);return t.close(),t.delete(),{internalFormat:r,compressedTexture:{type:\"compressed\",levels:s}}}function w(e){const t=new OffscreenCanvas(e.width,e.height),n=t.getContext(\"2d\");n.drawImage(e,0,0);return n.getImageData(0,0,t.width,t.height).data}function y(e,t,n,r,a){const l=new Uint8ClampedArray(e).subarray(0,t*n*r);if(!a)return l;const s=new Uint8ClampedArray(l.length),i=t*r;for(let o=0;o<n;o++){const e=o*i,t=(n-o-1)*i;s.set(l.subarray(e,e+i),t)}return s}const T=31,A=1,g=2,C=3,E=4,S=7,b=21,_=131072;function D(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}const M=D(\"DXT1\"),X=D(\"DXT3\"),R=D(\"DXT5\");function U(e,t){const n=new Int32Array(e.buffer,e.byteOffset,T);let r,l;switch(n[b]){case M:r=8,l=a.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case X:r=16,l=a.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case R:r=16,l=a.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}let s=1,i=n[E],o=n[C];(3&i||3&o)&&(i=i+3&-4,o=o+3&-4);const u=i,c=o;let h,f;n[g]&_&&!1!==t&&(s=Math.max(1,n[S]));let d=e.byteOffset+n[A]+4;const p=[];for(let a=0;a<s;++a)f=(i+3>>2)*(o+3>>2)*r,h=new Uint8Array(e.buffer,d,f),p.push(h),d+=f,i=Math.max(1,i>>1),o=Math.max(1,o>>1);return{textureData:{type:\"compressed\",levels:p},internalFormat:l,width:u,height:c}}export{u as TextureCompressionWorkerOutput,h as compress,p as compressRGBADataToKTX2,m as createTextureDataKTX2,c as destroy,f as initializeBasisEncoder,d as initializeDXTEncoder};\n"],"file":"assets/TextureCompressionWorker-CXULcBTh.js"}