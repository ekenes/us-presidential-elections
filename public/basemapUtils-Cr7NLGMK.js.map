{"version":3,"file":"basemapUtils-Cr7NLGMK.js","sources":["../../node_modules/@arcgis/core/support/basemapUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../core/Collection.js\";import{mappedFind as r}from\"../core/maybe.js\";import{Url as t,makeAbsolute as a,normalize as n}from\"../core/urlUtils.js\";import{effectEquals as l}from\"../layers/effects/utils.js\";import{esriBasemapDefinitions as i}from\"./basemapDefinitions.js\";function u(e){return\"Web Scene\"===e.portalItem?.type||e.referenceLayers.some((e=>\"scene\"===e.type))}function s(e){return!!e?.portalItem?.tags?.some((e=>\"beta\"===e.toLowerCase()))}function c(e,r){const t=e.allLayerViews.find((e=>e.uid===r));return t?.layer.parent===e.map?.basemap}let o;function f(e){if(o)return o(e);let r=null;const t=v(e),a=!t?.baseLayers.length;for(const n in i){const e=x(t,R(i[n]),{mustMatchReferences:a});if(\"equal\"===e){r=n;break}\"base-layers-equal\"===e&&(r=n)}return r}function p(e){o=e}function y(e,r){if(e===r)return!0;if(null!=e?.portalItem?.id&&e.portalItem.id===r?.portalItem?.id)return!0;return\"equal\"===x(v(e),v(r),{mustMatchReferences:!0})}function m(e){return!!e?.baseLayers.concat(e.referenceLayers).some(b)}function b(e){if(S(e.url))return!0;if(\"vector-tile\"===e.type)for(const r in e.sourceNameToSource){const t=e.sourceNameToSource[r];if(S(t?.sourceUrl))return!0}return!1}function d(e,r){if(null==r||null==e)return{spatialReference:null,updating:!1};if(\"not-loaded\"===r.loadStatus)return r.load(),{spatialReference:null,updating:!0};if(r.spatialReference)return{spatialReference:r.spatialReference,updating:!1};if(0===r.baseLayers.length)return{spatialReference:null,updating:!1};const t=r.baseLayers.at(0);switch(t.loadStatus){case\"not-loaded\":t.load();case\"loading\":return{spatialReference:null,updating:!0};case\"failed\":return{spatialReference:null,updating:!1}}const a=((\"supportedSpatialReferences\"in t?t.supportedSpatialReferences:null)||[\"tileInfo\"in t?t.tileInfo?.spatialReference:t.spatialReference]).filter(Boolean),n=e.spatialReference;return n?{spatialReference:a.find((e=>n.equals(e)))??a[0]??null,updating:!1}:{spatialReference:a[0],updating:!1}}const L=/^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;function S(e){if(!e)return!1;const r=new t(a(e));return!!r.authority&&L.test(r.authority)}function v(e){return e?!e.loaded&&e.resourceInfo?R(e.resourceInfo.data):{baseLayers:g(e.baseLayers),referenceLayers:g(e.referenceLayers)}:null}function g(r){return(e.isCollection(r)?r.toArray():r).map(I)}function I(e){return{type:e.type,effect:\"effect\"in e?e.effect:void 0,url:M(\"urlTemplate\"in e&&e.urlTemplate||e.url||\"styleUrl\"in e&&e.styleUrl||\"\"),minScale:\"minScale\"in e&&null!=e.minScale?e.minScale:0,maxScale:\"maxScale\"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:\"map-image\"!==e.type&&\"wms\"!==e.type||null==e.sublayers?void 0:e.sublayers?.map((e=>({id:e.id,visible:e.visible}))),activeLayerId:\"wmts\"===e.type?e.activeLayer?.id:void 0}}function h(e){return e.isReference||\"ArcGISSceneServiceLayer\"===e.layerType}function R(e){return e?{baseLayers:q((e.baseMapLayers??[]).filter((e=>!h(e)))),referenceLayers:q((e.baseMapLayers??[]).filter((e=>h(e))))}:null}function q(e){return e.map((e=>w(e)))}function w(e){let r;switch(e.layerType){case\"VectorTileLayer\":r=\"vector-tile\";break;case\"ArcGISTiledMapServiceLayer\":r=\"tile\";break;case\"ArcGISSceneServiceLayer\":r=\"scene\";break;default:r=\"unknown\"}return{type:r,effect:e.effect,url:M(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:e.minScale??0,maxScale:e.maxScale??0,opacity:e.opacity??1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}function x(e,r,t){if(null!=e!=(null!=r))return\"not-equal\";if(!e||!r)return\"equal\";if(!T(e.baseLayers,r.baseLayers))return\"not-equal\";return T(e.referenceLayers,r.referenceLayers)?\"equal\":t.mustMatchReferences?\"not-equal\":\"base-layers-equal\"}function T(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(!U(e[t],r[t]))return!1;return!0}function U(e,r){if(e.type!==r.type||e.url!==r.url||e.minScale!==r.minScale||e.maxScale!==r.maxScale||e.visible!==r.visible||e.opacity!==r.opacity)return!1;if(!l(e.effect,r.effect))return!1;if(null!=e.activeLayerId||null!=r.activeLayerId)return e.activeLayerId===r.activeLayerId;if(null!=e.sublayers||null!=r.sublayers){if(null==e.sublayers||null==r.sublayers||e.sublayers.length!==r.sublayers.length)return!1;for(let t=0;t<e.sublayers.length;t++){const a=e.sublayers.at(t),n=r.sublayers.at(t);if(a?.id!==n?.id||a?.visible!==n?.visible)return!1}}return!0}function M(e){return e?n(e).replace(/^\\s*https?:/i,\"\").toLowerCase():\"\"}function j(e){if(!e)return null;const{thumbnailUrl:t}=e;if(t)return t;const a=f(e);return a?i[a].thumbnailUrl:r(e.baseLayers,k)}function k(e){return\"portalItem\"in e?e.portalItem?.thumbnailUrl:void 0}export{y as contentEquals,d as findSpatialReference,j as getBasemapThumbnailUrl,f as getWellKnownBasemapId,m as hasDeveloperBasemapLayer,u as isBasemap3D,s as isBasemapInBeta,c as isBasemapLayerView,b as isDeveloperBasemapLayer,U as layerDefinitionEquals,I as layerToDefinition,p as overrideGetWellKnownBasemapId};\n"],"names":["c","r","t","e","_a","m","b","S","d","a","n","L"],"mappings":"iDAI4c,SAASA,EAAE,EAAEC,EAAE,OAAC,MAAMC,EAAE,EAAE,cAAc,MAAMC,GAAGA,EAAE,MAAMF,EAAC,EAAG,OAAOC,GAAA,YAAAA,EAAG,MAAM,YAASE,EAAA,EAAE,MAAF,YAAAA,EAAO,QAAO,CAA0Y,SAASC,EAAE,EAAE,CAAC,MAAM,CAAC,EAAC,WAAG,WAAW,OAAO,EAAE,iBAAiB,KAAKC,GAAE,CAAC,SAASA,EAAE,EAAE,CAAC,GAAGC,EAAE,EAAE,GAAG,EAAE,SAAS,GAAmB,EAAE,OAAlB,cAAuB,UAAUN,KAAK,EAAE,mBAAmB,CAAC,MAAMC,EAAE,EAAE,mBAAmBD,CAAC,EAAE,GAAGM,EAAEL,GAAA,YAAAA,EAAG,SAAS,EAAE,QAAQ,CAAC,QAAQ,CAAC,SAASM,EAAE,EAAEP,EAAE,OAAC,GAASA,GAAN,MAAe,GAAN,KAAQ,MAAM,CAAC,iBAAiB,KAAK,SAAS,EAAE,EAAE,GAAkBA,EAAE,aAAjB,aAA4B,OAAOA,EAAE,KAAI,EAAG,CAAC,iBAAiB,KAAK,SAAS,EAAE,EAAE,GAAGA,EAAE,iBAAiB,MAAM,CAAC,iBAAiBA,EAAE,iBAAiB,SAAS,EAAE,EAAE,GAAOA,EAAE,WAAW,SAAjB,EAAwB,MAAM,CAAC,iBAAiB,KAAK,SAAS,EAAE,EAAE,MAAMC,EAAED,EAAE,WAAW,GAAG,CAAC,EAAE,OAAOC,EAAE,WAAU,CAAE,IAAI,aAAaA,EAAE,OAAO,IAAI,UAAU,MAAM,CAAC,iBAAiB,KAAK,SAAS,EAAE,EAAE,IAAI,SAAS,MAAM,CAAC,iBAAiB,KAAK,SAAS,EAAE,CAAC,CAAC,MAAMO,IAAI,+BAA+BP,EAAEA,EAAE,2BAA2B,OAAO,CAAC,aAAaA,GAAEE,EAAAF,EAAE,WAAF,YAAAE,EAAY,iBAAiBF,EAAE,gBAAgB,GAAG,OAAO,OAAO,EAAEQ,EAAE,EAAE,iBAAiB,OAAOA,EAAE,CAAC,iBAAiBD,EAAE,MAAMN,GAAGO,EAAE,OAAOP,CAAC,EAAC,GAAIM,EAAE,CAAC,GAAG,KAAK,SAAS,EAAE,EAAE,CAAC,iBAAiBA,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC,MAAME,EAAE,6CAA6C,SAASJ,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,MAAM,GAAG,MAAMN,EAAE,IAAIC,EAAEO,EAAE,CAAC,CAAC,EAAE,MAAM,CAAC,CAACR,EAAE,WAAWU,EAAE,KAAKV,EAAE,SAAS,CAAC","x_google_ignoreList":[0]}